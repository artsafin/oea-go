{{ define "title"}}Office Invoice{{end}}

{{ define "sidebar"}}
    <a class="nav-link" href="{{ link "OfficeHome" }}">&larr; Return to all invoices</a>
    <a class="nav-link active" href="{{ link "OfficeShowInvoiceData" "invoice" .Page.SelectedInvoice }}">{{ .Page.SelectedInvoice }}</a>

        <br>
    <a type="button" class="btn btn-secondary" href="{{ link "OfficeDownloadInvoice" "invoice" .Page.SelectedInvoice }}">Download invoice</a>
{{end}}

{{ define "content"}}
    <!-- Generated at {{ .Page.Timestamp.Format "2006-01-02T15:04:05Z07:00" }} -->

    {{- if .Page.Error }}
        <div class="alert alert-danger" role="alert">{{ .Page.Error }}</div>
    {{- else }}
        <!-- no errors -->
    {{- end }}

<h3>{{ .Page.Office.Invoice.Date.Format "January 2006" }} Invoice</h3>

<table border="1" cellpadding="2" cellspacing="0" class="standart">
    <thead style="background-color: #cacaca">
        <tr>
            <th width="400">Item</th>
            <th width="100">Category</th>
            <th>Comment</th>
            <th width="150">RUB</th>
            <th width="150">EUR</th>
        </tr>
    </thead>
    <tbody>
        {{ range $group := .Page.Office.ExpenseGroups}}
            {{ range $expense := $group.Items}}
                <tr>
                    <td>{{ $expense.Subject }}</td>
                    <td style="white-space: nowrap">{{ $expense.Category }} </td>
                    <td>{{ $expense.CommentHTML }}</td>
                    <td style="text-align: right">{{ $expense.AmountRUBMoney }}</td>
                    <td style="text-align: right">{{ $expense.AmountEURMoney }}</td>
                </tr>
            {{ end }}
            <tr>
                <td></td>
                <td style="white-space: nowrap"><b>{{ $group.Name }}</b></td>
                <td></td>
                <td style="text-align: right">{{ $group.TotalRub }}</td>
                <td style="text-align: right">{{ $group.TotalEur }}</td>
            </tr>
        {{ end }}
        <tr>
            <td></td>
            <td><b>Expenses Total</b></td>
            <td></td>
            <td></td>
            <td style="text-align: right">{{ .Page.Office.Invoice.SubtotalMoney }}</td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td><b>Return of rounding</b></td>
            <td style="text-align: right" style="color: red">-{{ .Page.Office.Invoice.ReturnOfRoundingMoney }}</td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td>{{ .Page.Office.Invoice.Hours }} hours</td>
            <td><b>Rounding</b></td>
            <td style="text-align: right">{{ .Page.Office.Invoice.HourRateRoundingMoney }}</td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td><b>Total</b></td>
            <td style="text-align: right">{{ .Page.Office.Invoice.TotalEURMoney }}</td>
        </tr>
    </tbody>
</table>

<p><br /><br /></p>

<h3>Report on money usage ({{ .Page.Office.History.FirstInvoice.Date.Format "January 2006" }} &ndash; {{ .Page.Office.History.LastInvoice.Date.Format "January 2006" }})</h3>
<table border="1" cellpadding="2" cellspacing="0" width="100%" class="standart">
    <thead style="background-color: #cacaca">
        <tr>
            <th width="160">Invoice</th>
            <th width="230">Subject</th>
            <th width="90">Tag</th>
            <th width="40">Status</th>
            <th width="175">Requested Amount RUB</th>
            <th width="175">Actually spent</th>
            <th width="150">Pending spend</th>
            <th width="175">Under/over-use</th>
            <th width="310">Pending spend comment</th>
        </tr>
    </thead>
    <tbody>
        {{ range $invoice := .Page.Office.History.PastInvoices }}
            <tr bgcolor="{{if $invoice.HasPendingSpends}}#F6F9D4{{else}}#EEEEEE{{end}}">
                <td>{{ $invoice.No }}</td>
                <td></td>
                <td></td>
                <td>{{ $invoice.Status }}</td>
                <td style="text-align: right">{{ $invoice.ExpensesRUBMoney }}</td>
                <td style="text-align: right">{{ $invoice.ActuallySpentMoney }}</td>
                <td style="text-align: right">{{ $invoice.PendingSpendMoney }}</td>
                <td style="text-align: right">{{ $invoice.BalanceMoney }}</td>
                <td></td>
            </tr>
        {{ end }}

        {{ range $expense := .Page.Office.History.LastInvoice.PlannedExpenses.All }}
            <tr bgcolor="{{if $expense.HasPendingSpends}}#F6F9D4{{else}}#FFFFFF{{end}}">
                <td>{{ $expense.Invoice }}</td>
                <td>{{ $expense.Subject }}</td>
                <td>{{ $expense.Category }}</td>
                <td>{{ $expense.Status }}</td>
                <td style="text-align: right">{{ $expense.AmountRUBMoney }}</td>
                <td style="text-align: right">{{ $expense.ActuallySpentMoney }}</td>
                <td style="text-align: right">{{ $expense.PendingSpendMoney }}</td>
                <td style="text-align: right">{{ $expense.BalanceMoney }}</td>
                <td></td>
            </tr>
        {{ end }}
        <tr style="font-weight: bold">
            <td>{{ .Page.Office.History.LastInvoice.No }} Subtotal</td>
            <td></td>
            <td></td>
            <td></td>
            <td style="text-align: right">{{ .Page.Office.History.LastInvoice.ExpensesRUBMoney }}</td>
            <td style="text-align: right">{{ .Page.Office.History.LastInvoice.ActuallySpentMoney }}</td>
            <td style="text-align: right">{{ .Page.Office.History.LastInvoice.PendingSpendMoney }}</td>
            <td style="text-align: right">{{ .Page.Office.History.LastInvoice.BalanceMoney }}</td>
            <td></td>
        </tr>
        <tr style="font-weight: bold">
            <td>Grand total</td>
            <td></td>
            <td></td>
            <td></td>
            <td style="text-align: right">{{ .Page.Office.History.GrandTotal.ExpensesRub }}</td>
            <td style="text-align: right">{{ .Page.Office.History.GrandTotal.ActuallySpent }}</td>
            <td style="text-align: right">{{ .Page.Office.History.GrandTotal.PendingSpend }}</td>
            <td style="text-align: right">{{ .Page.Office.History.GrandTotal.Balance }}</td>
            <td></td>
        </tr>
    </tbody>
</table>

<p><br></p>

{{end}}
